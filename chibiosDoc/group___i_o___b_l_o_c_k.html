<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ChibiOS/HAL: Abstract I/O Block Device</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ChibiOS/HAL
   &#160;<span id="projectnumber">6.0.0</span>
<script type="text/javascript"><!--
google_ad_client = "pub-3840594581853944";
/* Documentation, bottom, 728x90, created 9/19/10 */
google_ad_slot = "1902290615";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___i_o___b_l_o_c_k.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a>  </div>
  <div class="headertitle">
<div class="title">Abstract I/O Block Device<div class="ingroups"><a class="el" href="group___i_o.html">HAL</a> &raquo; <a class="el" href="group___h_a_l___i_n_t_e_r_f_a_c_e_s.html">Interfaces</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Abstract I/O Block Device:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group___i_o___b_l_o_c_k.png" border="0" alt="" usemap="#group______i__o______b__l__o__c__k"/>
<map name="group______i__o______b__l__o__c__k" id="group______i__o______b__l__o__c__k">
<area shape="rect" id="node1" href="group___h_a_l___i_n_t_e_r_f_a_c_e_s.html" title="HAL Interfaces. " alt="" coords="5,11,75,35"/>
</map>
</td></tr></table></center>
</div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="io_block_1"></a>
Driver State Machine</h1>
<p>The drivers implementing this interface shall implement the following state machine internally. Not all the driver functionalities can be used in any moment, any transition not explicitly shown in the following diagram has to be considered an error and shall be captured by an assertion (if enabled). </p><div align="center">
<img src="dot_inline_dotgraph_5.png" alt="dot_inline_dotgraph_5.png" border="0" usemap="#dot_inline_dotgraph_5.map"/>
<map name="dot_inline_dotgraph_5.map" id="dot_inline_dotgraph_5.map"></map>
</div>
<p>This module defines an abstract interface for accessing generic block devices.<br />
 Note that no code is present, just abstract interfaces-like structures, you should look at the system as to a set of abstract C++ classes (even if written in C). This system has then advantage to make the access to block devices independent from the implementation logic. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga5127195a557a1456b254330b6b9a45c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga5127195a557a1456b254330b6b9a45c6">_base_block_device_methods</a></td></tr>
<tr class="memdesc:ga5127195a557a1456b254330b6b9a45c6"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> specific methods.  <a href="#ga5127195a557a1456b254330b6b9a45c6">More...</a><br /></td></tr>
<tr class="separator:ga5127195a557a1456b254330b6b9a45c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3784bc02a5a98cbf96490898c1a0584"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#gaa3784bc02a5a98cbf96490898c1a0584">_base_block_device_data</a></td></tr>
<tr class="memdesc:gaa3784bc02a5a98cbf96490898c1a0584"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> specific data.  <a href="#gaa3784bc02a5a98cbf96490898c1a0584">More...</a><br /></td></tr>
<tr class="separator:gaa3784bc02a5a98cbf96490898c1a0584"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Macro Functions (BaseBlockDevice)</h2></td></tr>
<tr class="memitem:ga673b0cd2fda9667c1bfcc827e98bf52b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga673b0cd2fda9667c1bfcc827e98bf52b">blkGetDriverState</a>(ip)&#160;&#160;&#160;((ip)-&gt;state)</td></tr>
<tr class="memdesc:ga673b0cd2fda9667c1bfcc827e98bf52b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the driver state.  <a href="#ga673b0cd2fda9667c1bfcc827e98bf52b">More...</a><br /></td></tr>
<tr class="separator:ga673b0cd2fda9667c1bfcc827e98bf52b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1572a9c945cfc54620c11c36813dc4d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga1572a9c945cfc54620c11c36813dc4d6">blkIsTransferring</a>(ip)</td></tr>
<tr class="memdesc:ga1572a9c945cfc54620c11c36813dc4d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if the device is transferring data.  <a href="#ga1572a9c945cfc54620c11c36813dc4d6">More...</a><br /></td></tr>
<tr class="separator:ga1572a9c945cfc54620c11c36813dc4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb51617cec494e5018d22ea8c6aa4492"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#gafb51617cec494e5018d22ea8c6aa4492">blkIsInserted</a>(ip)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;is_inserted(ip))</td></tr>
<tr class="memdesc:gafb51617cec494e5018d22ea8c6aa4492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the media insertion status.  <a href="#gafb51617cec494e5018d22ea8c6aa4492">More...</a><br /></td></tr>
<tr class="separator:gafb51617cec494e5018d22ea8c6aa4492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7d18dbab8c61ae700530f67091e94d30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga7d18dbab8c61ae700530f67091e94d30">blkIsWriteProtected</a>(ip)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;is_protected(ip))</td></tr>
<tr class="memdesc:ga7d18dbab8c61ae700530f67091e94d30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the media write protection status.  <a href="#ga7d18dbab8c61ae700530f67091e94d30">More...</a><br /></td></tr>
<tr class="separator:ga7d18dbab8c61ae700530f67091e94d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4df92074d6c8b0cc7e6df18130623f2b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga4df92074d6c8b0cc7e6df18130623f2b">blkConnect</a>(ip)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;connect(ip))</td></tr>
<tr class="memdesc:ga4df92074d6c8b0cc7e6df18130623f2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the initialization procedure on the block device.  <a href="#ga4df92074d6c8b0cc7e6df18130623f2b">More...</a><br /></td></tr>
<tr class="separator:ga4df92074d6c8b0cc7e6df18130623f2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad45f92e6b133d8d0f86304b5343c6e55"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#gad45f92e6b133d8d0f86304b5343c6e55">blkDisconnect</a>(ip)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;disconnect(ip))</td></tr>
<tr class="memdesc:gad45f92e6b133d8d0f86304b5343c6e55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminates operations on the block device.  <a href="#gad45f92e6b133d8d0f86304b5343c6e55">More...</a><br /></td></tr>
<tr class="separator:gad45f92e6b133d8d0f86304b5343c6e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf6caf52a0453a73eeaa7ebfa82bfc40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#gadf6caf52a0453a73eeaa7ebfa82bfc40">blkRead</a>(ip,  startblk,  buf,  n)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;read(ip, startblk, buf, n))</td></tr>
<tr class="memdesc:gadf6caf52a0453a73eeaa7ebfa82bfc40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads one or more blocks.  <a href="#gadf6caf52a0453a73eeaa7ebfa82bfc40">More...</a><br /></td></tr>
<tr class="separator:gadf6caf52a0453a73eeaa7ebfa82bfc40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93174f6445b3f404401db53ef8062a57"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga93174f6445b3f404401db53ef8062a57">blkWrite</a>(ip,  startblk,  buf,  n)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;write(ip, startblk, buf, n))</td></tr>
<tr class="memdesc:ga93174f6445b3f404401db53ef8062a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes one or more blocks.  <a href="#ga93174f6445b3f404401db53ef8062a57">More...</a><br /></td></tr>
<tr class="separator:ga93174f6445b3f404401db53ef8062a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafda8997f75a88f1bfb18315dd79f5bc9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#gafda8997f75a88f1bfb18315dd79f5bc9">blkSync</a>(ip)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;<a class="el" href="group___m_m_c___s_p_i.html#gab09e4d4341eff30aadfbc5da9ec804e4">sync</a>(ip))</td></tr>
<tr class="memdesc:gafda8997f75a88f1bfb18315dd79f5bc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensures write synchronization.  <a href="#gafda8997f75a88f1bfb18315dd79f5bc9">More...</a><br /></td></tr>
<tr class="separator:gafda8997f75a88f1bfb18315dd79f5bc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2cdfa93c13dc81b0a34d2f4121986f57"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_o___b_l_o_c_k.html#ga2cdfa93c13dc81b0a34d2f4121986f57">blkGetInfo</a>(ip,  bdip)&#160;&#160;&#160;((ip)-&gt;vmt-&gt;get_info(ip, bdip))</td></tr>
<tr class="memdesc:ga2cdfa93c13dc81b0a34d2f4121986f57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a media information structure.  <a href="#ga2cdfa93c13dc81b0a34d2f4121986f57">More...</a><br /></td></tr>
<tr class="separator:ga2cdfa93c13dc81b0a34d2f4121986f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_block_device_info.html">BlockDeviceInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block device info.  <a href="struct_block_device_info.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_base_block_device_v_m_t.html">BaseBlockDeviceVMT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> virtual methods table.  <a href="struct_base_block_device_v_m_t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_base_block_device.html">BaseBlockDevice</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base block device class.  <a href="struct_base_block_device.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga5127195a557a1456b254330b6b9a45c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _base_block_device_methods</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="comment">/* Removable media detection.*/</span>                                           \</div><div class="line">  bool (*is_inserted)(<span class="keywordtype">void</span> *instance);                                      \</div><div class="line">  <span class="comment">/* Removable write protection detection.*/</span>                                \</div><div class="line">  bool (*is_protected)(<span class="keywordtype">void</span> *instance);                                     \</div><div class="line">  <span class="comment">/* Connection to the block device.*/</span>                                      \</div><div class="line">  bool (*connect)(<span class="keywordtype">void</span> *instance);                                          \</div><div class="line">  <span class="comment">/* Disconnection from the block device.*/</span>                                 \</div><div class="line">  bool (*disconnect)(<span class="keywordtype">void</span> *instance);                                       \</div><div class="line">  <span class="comment">/* Reads one or more blocks.*/</span>                                            \</div><div class="line">  bool (*read)(<span class="keywordtype">void</span> *instance, uint32_t startblk,                           \</div><div class="line">                 uint8_t *buffer, uint32_t n);                              \</div><div class="line">  <span class="comment">/* Writes one or more blocks.*/</span>                                           \</div><div class="line">  bool (*write)(<span class="keywordtype">void</span> *instance, uint32_t startblk,                          \</div><div class="line">                  const uint8_t *buffer, uint32_t n);                       \</div><div class="line">  <span class="comment">/* Write operations synchronization.*/</span>                                    \</div><div class="line">  bool (*<a class="code" href="group___m_m_c___s_p_i.html#gab09e4d4341eff30aadfbc5da9ec804e4">sync</a>)(<span class="keywordtype">void</span> *instance);                                             \</div><div class="line">  <span class="comment">/* Obtains info about the media.*/</span>                                        \</div><div class="line">  bool (*get_info)(<span class="keywordtype">void</span> *instance, <a class="code" href="struct_block_device_info.html">BlockDeviceInfo</a> *bdip);</div><div class="ttc" id="struct_block_device_info_html"><div class="ttname"><a href="struct_block_device_info.html">BlockDeviceInfo</a></div><div class="ttdoc">Block device info. </div><div class="ttdef"><b>Definition:</b> <a href="hal__ioblock_8h_source.html#l00055">hal_ioblock.h:55</a></div></div>
<div class="ttc" id="group___m_m_c___s_p_i_html_gab09e4d4341eff30aadfbc5da9ec804e4"><div class="ttname"><a href="group___m_m_c___s_p_i.html#gab09e4d4341eff30aadfbc5da9ec804e4">sync</a></div><div class="ttdeci">static void sync(MMCDriver *mmcp)</div><div class="ttdoc">Waits that the card reaches an idle state. </div><div class="ttdef"><b>Definition:</b> <a href="hal__mmc__spi_8c_source.html#l00354">hal_mmc_spi.c:354</a></div></div>
</div><!-- fragment -->
<p><code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> specific methods. </p>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00063">63</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="gaa3784bc02a5a98cbf96490898c1a0584"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _base_block_device_data</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="comment">/* Driver state.*/</span>                                                        <a class="code" href="group___i_o___b_l_o_c_k.html#ga1f189b51767bd55ccc145f43b9a363b9">\</a></div><div class="line"><a class="code" href="group___i_o___b_l_o_c_k.html#ga1f189b51767bd55ccc145f43b9a363b9">  blkstate_t</a>            state;</div><div class="ttc" id="group___i_o___b_l_o_c_k_html_ga1f189b51767bd55ccc145f43b9a363b9"><div class="ttname"><a href="group___i_o___b_l_o_c_k.html#ga1f189b51767bd55ccc145f43b9a363b9">blkstate_t</a></div><div class="ttdeci">blkstate_t</div><div class="ttdoc">Driver state machine possible states. </div><div class="ttdef"><b>Definition:</b> <a href="hal__ioblock_8h_source.html#l00040">hal_ioblock.h:40</a></div></div>
</div><!-- fragment -->
<p><code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> specific data. </p>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00086">86</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga673b0cd2fda9667c1bfcc827e98bf52b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkGetDriverState</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td>&#160;&#160;&#160;((ip)-&gt;state)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the driver state. </p>
<dl class="section note"><dt>Note</dt><dd>Can be called in ISR context.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The driver state.</dd></dl>
<dl class="section user"><dt>Function Class:</dt><dd>Special function, this function has special requirements see the notes. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00121">121</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga1572a9c945cfc54620c11c36813dc4d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkIsTransferring</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">((((ip)-&gt;state) == <a class="code" href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9a362f871d23123b518baedc38f0d8e99a">BLK_CONNECTING</a>) ||         \</div><div class="line">                               (((ip)-&gt;state) == <a class="code" href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9aaf1cbda180cfdc42751cb06d54372f7f">BLK_DISCONNECTING</a>) ||      \</div><div class="line">                               (((ip)-&gt;state) == <a class="code" href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9ab1db560d5a0a6d7aff6b522c605004ff">BLK_READING</a>) ||            \</div><div class="line">                               (((ip)-&gt;state) == <a class="code" href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9a081cbd0b13e70eced066b9465be782f5">BLK_WRITING</a>))</div><div class="ttc" id="group___i_o___b_l_o_c_k_html_gga1f189b51767bd55ccc145f43b9a363b9aaf1cbda180cfdc42751cb06d54372f7f"><div class="ttname"><a href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9aaf1cbda180cfdc42751cb06d54372f7f">BLK_DISCONNECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="hal__ioblock_8h_source.html#l00045">hal_ioblock.h:45</a></div></div>
<div class="ttc" id="group___i_o___b_l_o_c_k_html_gga1f189b51767bd55ccc145f43b9a363b9a362f871d23123b518baedc38f0d8e99a"><div class="ttname"><a href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9a362f871d23123b518baedc38f0d8e99a">BLK_CONNECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="hal__ioblock_8h_source.html#l00044">hal_ioblock.h:44</a></div></div>
<div class="ttc" id="group___i_o___b_l_o_c_k_html_gga1f189b51767bd55ccc145f43b9a363b9a081cbd0b13e70eced066b9465be782f5"><div class="ttname"><a href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9a081cbd0b13e70eced066b9465be782f5">BLK_WRITING</a></div><div class="ttdef"><b>Definition:</b> <a href="hal__ioblock_8h_source.html#l00048">hal_ioblock.h:48</a></div></div>
<div class="ttc" id="group___i_o___b_l_o_c_k_html_gga1f189b51767bd55ccc145f43b9a363b9ab1db560d5a0a6d7aff6b522c605004ff"><div class="ttname"><a href="group___i_o___b_l_o_c_k.html#gga1f189b51767bd55ccc145f43b9a363b9ab1db560d5a0a6d7aff6b522c605004ff">BLK_READING</a></div><div class="ttdef"><b>Definition:</b> <a href="hal__ioblock_8h_source.html#l00047">hal_ioblock.h:47</a></div></div>
</div><!-- fragment -->
<p>Determines if the device is transferring data. </p>
<dl class="section note"><dt>Note</dt><dd>Can be called in ISR context.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The driver state. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>the device is not transferring data. </td></tr>
    <tr><td class="paramname">true</td><td>the device not transferring data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Special function, this function has special requirements see the notes. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00135">135</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="gafb51617cec494e5018d22ea8c6aa4492"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkIsInserted</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;is_inserted(ip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the media insertion status. </p>
<dl class="section note"><dt>Note</dt><dd>On some implementations this function can only be called if the device is not transferring data. The function <code><a class="el" href="group___i_o___b_l_o_c_k.html#ga1572a9c945cfc54620c11c36813dc4d6" title="Determines if the device is transferring data. ">blkIsTransferring()</a></code> should be used before calling this function.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The media state. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>media not inserted. </td></tr>
    <tr><td class="paramname">true</td><td>media inserted.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00155">155</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga7d18dbab8c61ae700530f67091e94d30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkIsWriteProtected</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;is_protected(ip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the media write protection status. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The media state. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">false</td><td>writable media. </td></tr>
    <tr><td class="paramname">true</td><td>non writable media.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00168">168</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga4df92074d6c8b0cc7e6df18130623f2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkConnect</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;connect(ip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the initialization procedure on the block device. </p>
<p>This function should be performed before I/O operations can be attempted on the block device and after insertion has been confirmed using <code><a class="el" href="group___i_o___b_l_o_c_k.html#gafb51617cec494e5018d22ea8c6aa4492" title="Returns the media insertion status. ">blkIsInserted()</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The operation status. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL_SUCCESS</td><td>operation succeeded. </td></tr>
    <tr><td class="paramname">HAL_FAILED</td><td>operation failed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00184">184</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad45f92e6b133d8d0f86304b5343c6e55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkDisconnect</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;disconnect(ip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminates operations on the block device. </p>
<p>This operation safely terminates operations on the block device.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The operation status. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL_SUCCESS</td><td>operation succeeded. </td></tr>
    <tr><td class="paramname">HAL_FAILED</td><td>operation failed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00198">198</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="gadf6caf52a0453a73eeaa7ebfa82bfc40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkRead</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">startblk, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;read(ip, startblk, buf, n))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads one or more blocks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startblk</td><td>first block to read </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to the read buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of blocks to read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The operation status. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL_SUCCESS</td><td>operation succeeded. </td></tr>
    <tr><td class="paramname">HAL_FAILED</td><td>operation failed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00214">214</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga93174f6445b3f404401db53ef8062a57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkWrite</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">startblk, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buf, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;write(ip, startblk, buf, n))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes one or more blocks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">startblk</td><td>first block to write </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to the write buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>number of blocks to write</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The operation status. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL_SUCCESS</td><td>operation succeeded. </td></tr>
    <tr><td class="paramname">HAL_FAILED</td><td>operation failed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00231">231</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="gafda8997f75a88f1bfb18315dd79f5bc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkSync</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip</td><td>)</td>
          <td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;<a class="el" href="group___m_m_c___s_p_i.html#gab09e4d4341eff30aadfbc5da9ec804e4">sync</a>(ip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ensures write synchronization. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The operation status. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL_SUCCESS</td><td>operation succeeded. </td></tr>
    <tr><td class="paramname">HAL_FAILED</td><td>operation failed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00245">245</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga2cdfa93c13dc81b0a34d2f4121986f57"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define blkGetInfo</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ip, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bdip&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((ip)-&gt;vmt-&gt;get_info(ip, bdip))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns a media information structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>pointer to a <code><a class="el" href="struct_base_block_device.html" title="Base block device class. ">BaseBlockDevice</a></code> or derived class </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bdip</td><td>pointer to a <code><a class="el" href="struct_block_device_info.html" title="Block device info. ">BlockDeviceInfo</a></code> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The operation status. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">HAL_SUCCESS</td><td>operation succeeded. </td></tr>
    <tr><td class="paramname">HAL_FAILED</td><td>operation failed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00259">259</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga1f189b51767bd55ccc145f43b9a363b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group___i_o___b_l_o_c_k.html#ga1f189b51767bd55ccc145f43b9a363b9">blkstate_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Driver state machine possible states. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9a9ce0e9a6dcfd348c70142327c80cfad7"></a>BLK_UNINIT&#160;</td><td class="fielddoc">
<p>Not initialized. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9a3342157627fffeacb36b858f4ac1e0d8"></a>BLK_STOP&#160;</td><td class="fielddoc">
<p>Stopped. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9aeb430f851f699da53ba7589808edf948"></a>BLK_ACTIVE&#160;</td><td class="fielddoc">
<p>Interface active. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9a362f871d23123b518baedc38f0d8e99a"></a>BLK_CONNECTING&#160;</td><td class="fielddoc">
<p>Connection in progress. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9aaf1cbda180cfdc42751cb06d54372f7f"></a>BLK_DISCONNECTING&#160;</td><td class="fielddoc">
<p>Disconnection in progress. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9a97b7a7ddb6b18c693d1f52e7163eed0f"></a>BLK_READY&#160;</td><td class="fielddoc">
<p>Device ready. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9ab1db560d5a0a6d7aff6b522c605004ff"></a>BLK_READING&#160;</td><td class="fielddoc">
<p>Read operation in progress. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9a081cbd0b13e70eced066b9465be782f5"></a>BLK_WRITING&#160;</td><td class="fielddoc">
<p>Write operation in progress. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="gga1f189b51767bd55ccc145f43b9a363b9ac8b6a64a1b2aac40bd452167cd9fdfbe"></a>BLK_SYNCING&#160;</td><td class="fielddoc">
<p>Sync. operation in progress. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="hal__ioblock_8h_source.html#l00040">40</a> of file <a class="el" href="hal__ioblock_8h_source.html">hal_ioblock.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun May 13 2018 00:51:42 for ChibiOS/HAL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
